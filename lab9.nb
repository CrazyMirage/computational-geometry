(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     74424,       1696]
NotebookOptionsPosition[     73884,       1675]
NotebookOutlinePosition[     74228,       1690]
CellTagsIndexPosition[     74185,       1687]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "\:0410\:043b\:0433\:0430\:0440\:0438\:0442\:043c", " ", 
    "\:0413\:0440\:044d\:0445\:0430\:043c\:0430"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"PolygonBilder", "[", "points_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"P", " ", "=", " ", 
        RowBox[{"List", "[", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Pl", " ", "=", " ", 
        RowBox[{"List", "[", "]"}]}], ",", 
       RowBox[{"Pr", " ", "=", " ", 
        RowBox[{"List", "[", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Sl", " ", "=", " ", 
        RowBox[{"List", "[", "]"}]}], ",", " ", 
       RowBox[{"Sr", "=", " ", 
        RowBox[{"List", "[", "]"}]}], ",", "\[IndentingNewLine]", "PlPoint", 
       " ", ",", " ", "PrPoint", ",", "\[IndentingNewLine]", "length", ",", 
       "n", ",", "\[IndentingNewLine]", "result"}], "\[IndentingNewLine]", 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"length", " ", "=", " ", 
       RowBox[{"Length", "[", "points", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"PlPoint", " ", "=", " ", 
       RowBox[{"Part", "[", 
        RowBox[{"points", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"PrPoint", " ", "=", 
       RowBox[{"Part", "[", 
        RowBox[{"points", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "\:043d\:0430\:0445\:043e\:0434\:0438\:043c", " ", 
        "\:043c\:0438\:043d\:0438\:043c\:0443\:043c\:0430\:043b\:044c\:043d\
\:0443\:044e", " ", "\:0438", " ", 
        "\:043c\:0430\:043a\:0441\:0438\:043c\:0430\:043b\:044c\:043d\:0443\
\:044e", " ", "\:043f\:043e", " ", "\:0438\:043a\:0441\:0430\:043c", " ", 
        "\:0442\:043e\:0447\:043a\:0443"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"n", " ", "=", " ", "2"}], ",", " ", 
        RowBox[{"n", " ", "\[LessEqual]", "  ", "length"}], ",", 
        RowBox[{"++", "n"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{"points", ",", "n"}], "]"}], ",", "1"}], "]"}], "<", 
            RowBox[{"Part", "[", 
             RowBox[{"PlPoint", ",", "1"}], "]"}]}], ",", 
           RowBox[{"PlPoint", " ", "=", 
            RowBox[{"Part", "[", 
             RowBox[{"points", ",", "n"}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{"points", ",", "n"}], "]"}], ",", "1"}], "]"}], ">", 
            RowBox[{"Part", "[", 
             RowBox[{"PrPoint", ",", "1"}], "]"}]}], ",", 
           RowBox[{"PrPoint", " ", "=", 
            RowBox[{"Part", "[", 
             RowBox[{"points", ",", "n"}], "]"}]}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "\:0434\:0435\:043b\:0438\:043c", " ", 
        "\:043c\:043d\:043e\:0436\:0435\:0441\:0442\:0432\:043e", " ", 
        "\:043d\:0430", " ", "\:0434\:0432\:0430", " ", 
        "\:043f\:043e\:0434\:043c\:043d\:043e\:0436\:0435\:0441\:0442\:0432\
\:0430"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"n", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"n", " ", "\[LessEqual]", "  ", "length"}], ",", 
        RowBox[{"++", "n"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"points", ",", " ", "n"}], "]"}], "\[Equal]", " ", 
             "PlPoint"}], " ", "||", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"points", ",", " ", "n"}], "]"}], "\[Equal]", " ", 
             "PrPoint"}]}], ",", ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Det", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"PrPoint", "-", "PlPoint"}], ",", 
                 RowBox[{
                  RowBox[{"Part", "[", 
                   RowBox[{"points", ",", " ", "n"}], "]"}], "-", 
                  "PlPoint"}]}], " ", "}"}], "]"}], "<", "0"}], ",", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"Pr", ",", 
               RowBox[{"Part", "[", 
                RowBox[{"points", ",", " ", "n"}], "]"}]}], "]"}], ",", " ", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"Pl", ",", 
               RowBox[{"Part", "[", 
                RowBox[{"points", ",", " ", "n"}], "]"}]}], "]"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "\:0432\:0435\:0440\:043d\:0435\:043c", " ", 
        "\:0442\:043e\:0447\:043a\:0438", " ", "\:0430", " ", "\:0442\:043e", 
        " ", "\:043d\:0435", " ", "\:0445\:043e"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"Pr", ",", " ", "PlPoint"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"Pl", ",", " ", "PrPoint"}], "]"}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
      "(*", "\:0443\:043f\:043e\:0440\:044f\:0434\:043e\:0447\:0438\:0432\
\:0430\:0435\:043c", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Pr", " ", "=", " ", 
       RowBox[{"SortBy", "[", 
        RowBox[{"Pr", ",", " ", "First"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Pl", "=", " ", 
       RowBox[{"SortBy", "[", 
        RowBox[{"Pl", ",", " ", "First"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "\:043f\:043e\:0441\:0442\:0440\:043e\:0435\:043d\:0438\:0435", " ", 
        "\:0432\:044b\:043f\:0443\:043a\:043b\:043e\:0439", " ", 
        "\:043e\:0431\:043e\:043b\:043e\:0447\:043a\:0438", " ", 
        "\:0434\:043b\:044f", " ", 
        "\:043c\:043d\:043e\:0436\:0435\:0441\:0442\:0432\:0430", " ", "Pl"}],
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"length", " ", "=", " ", 
       RowBox[{"Length", "[", "Pl", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"Sl", ",", " ", "PlPoint"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"n", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"n", " ", "\[LessEqual]", "  ", "length"}], ",", 
        RowBox[{"++", "n"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "Sl", "]"}], "\[Equal]", " ", "1"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"Sl", ",", 
             RowBox[{"Part", "[", 
              RowBox[{"Pl", ",", "n"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Det", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Part", "[", 
                    RowBox[{"Sl", ",", " ", 
                    RowBox[{"Length", "[", "Sl", "]"}]}], "]"}], "-", 
                   RowBox[{"Part", "[", 
                    RowBox[{"Sl", ",", " ", 
                    RowBox[{
                    RowBox[{"Length", "[", "Sl", "]"}], "-", "1"}]}], "]"}]}],
                   ",", 
                  RowBox[{
                   RowBox[{"Part", "[", 
                    RowBox[{"Pl", ",", " ", "n"}], "]"}], "-", 
                   RowBox[{"Part", "[", 
                    RowBox[{"Sl", ",", " ", 
                    RowBox[{
                    RowBox[{"Length", "[", "Sl", "]"}], "-", "1"}]}], 
                    "]"}]}]}], " ", "}"}], "]"}], "\[LessEqual]", " ", "0"}], 
              ",", "\[IndentingNewLine]", " ", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{"Sl", ",", 
                 RowBox[{"Part", "[", 
                  RowBox[{"Pl", ",", "n"}], "]"}]}], "]"}], ";"}], ",", 
              "\[IndentingNewLine]", " ", 
              RowBox[{
               RowBox[{"Sl", " ", "=", " ", 
                RowBox[{"Delete", "[", 
                 RowBox[{"Sl", ",", " ", 
                  RowBox[{"Length", "[", "Sl", "]"}]}], "]"}]}], ";", " ", 
               RowBox[{"n", "--"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "\:043f\:043e\:0441\:0442\:0440\:043e\:0435\:043d\:0438\:0435", " ", 
        "\:0432\:044b\:043f\:0443\:043a\:043b\:043e\:0439", " ", 
        "\:043e\:0431\:043e\:043b\:043e\:0447\:043a\:0438", " ", 
        "\:0434\:043b\:044f", " ", 
        "\:043c\:043d\:043e\:0436\:0435\:0441\:0442\:0432\:0430", " ", "Pr"}],
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"length", " ", "=", " ", 
       RowBox[{"Length", "[", "Pr", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"Sr", ",", " ", "PrPoint"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"n", " ", "=", " ", "length"}], ",", "   ", 
        RowBox[{"1", "\[LessEqual]", " ", "n"}], ",", 
        RowBox[{"--", "n"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "Sr", "]"}], "\[Equal]", " ", "1"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"Sr", ",", 
             RowBox[{"Part", "[", 
              RowBox[{"Pr", ",", "n"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Det", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Part", "[", 
                    RowBox[{"Sr", ",", " ", 
                    RowBox[{"Length", "[", "Sr", "]"}]}], "]"}], "-", 
                   RowBox[{"Part", "[", 
                    RowBox[{"Sr", ",", " ", 
                    RowBox[{
                    RowBox[{"Length", "[", "Sr", "]"}], "-", "1"}]}], "]"}]}],
                   ",", 
                  RowBox[{
                   RowBox[{"Part", "[", 
                    RowBox[{"Pr", ",", " ", "n"}], "]"}], "-", 
                   RowBox[{"Part", "[", 
                    RowBox[{"Sr", ",", " ", 
                    RowBox[{
                    RowBox[{"Length", "[", "Sr", "]"}], "-", "1"}]}], 
                    "]"}]}]}], " ", "}"}], "]"}], "<", " ", "0"}], ",", 
              "\[IndentingNewLine]", " ", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{"Sr", ",", 
                 RowBox[{"Part", "[", 
                  RowBox[{"Pr", ",", "n"}], "]"}]}], "]"}], ";"}], ",", 
              "\[IndentingNewLine]", " ", 
              RowBox[{
               RowBox[{"Sr", " ", "=", " ", 
                RowBox[{"Delete", "[", 
                 RowBox[{"Sr", ",", " ", 
                  RowBox[{"Length", "[", "Sr", "]"}]}], "]"}]}], ";", " ", 
               RowBox[{"n", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Sr", " ", "=", " ", 
       RowBox[{"Delete", "[", 
        RowBox[{"Sr", ",", " ", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"result", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{"Sl", ",", "Sr"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "result", "]"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.621753896520835*^9, 3.6217539034972343`*^9}, {
   3.622694277739565*^9, 3.622694278925167*^9}, 3.623953318068241*^9}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"KickPoints", "[", "polygon_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"Complement", "[", 
        RowBox[{"points", ",", "polygon"}], "]"}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6257230305634556`*^9, 3.6257230970663724`*^9}, {
   3.6257231398884478`*^9, 3.62572316409969*^9}, {3.6257233579768305`*^9, 
   3.6257233953856964`*^9}, {3.6257234404229755`*^9, 3.62572346575742*^9}, 
   3.625723548874366*^9}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Test", "[", 
     RowBox[{"p1_", ",", "p2_", ",", "p3_", ",", "p4_"}], "]"}], " ", ":=", 
    " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "result", ",", "\[IndentingNewLine]", "\[Alpha]", ",", " ", "\[Beta]", 
        ",", " ", "k"}], "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Alpha]", " ", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", 
             RowBox[{"p1", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p4", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", 
             RowBox[{"p1", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], " ", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p2", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", 
             RowBox[{"p1", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p4", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", 
             RowBox[{"p1", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], ")"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Beta]", " ", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", 
             RowBox[{"p3", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p4", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", 
             RowBox[{"p3", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], " ", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p2", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", 
             RowBox[{"p3", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p4", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", 
             RowBox[{"p3", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], ")"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Alpha]", ">", "0"}], " ", "&&", 
          RowBox[{"\[Beta]", " ", ">", " ", "0"}]}], ",", " ", 
         RowBox[{"result", " ", "=", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Alpha]", "<", "0"}], " ", "&&", 
             RowBox[{"\[Beta]", " ", "<", " ", "0"}]}], ",", " ", 
            RowBox[{"result", " ", "=", "False"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"k", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"p1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p4", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"p1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], "-", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p4", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"p1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"p1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], "]"}], "*", 
                "\[Beta]"}], " ", "\[IndentingNewLine]", "+", " ", 
               RowBox[{"\[Alpha]", "*", " ", 
                RowBox[{"Abs", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"p3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p4", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"p3", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], "-", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p4", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"p3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"p3", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], "]"}]}]}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"result", " ", "=", " ", 
              RowBox[{"k", "\[GreaterEqual]", "0"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "result", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Flip", "[", "index_", "]"}], " ", ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "segmentN", ",", "\[IndentingNewLine]", "triangle1", ",", "triangle2", 
        ",", "\[IndentingNewLine]", "t1i", ",", "t2i", ",", 
        "\[IndentingNewLine]", "temp1", ",", "temp2"}], "\[IndentingNewLine]",
        "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"t1i", " ", "=", 
        RowBox[{
         RowBox[{"st", "[", 
          RowBox[{"[", "index", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"t2i", " ", "=", " ", 
        RowBox[{
         RowBox[{"st", "[", 
          RowBox[{"[", "index", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"triangle1", " ", "=", " ", 
        RowBox[{"triangles", "[", 
         RowBox[{"[", "t1i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"triangle2", " ", "=", " ", 
        RowBox[{"triangles", "[", 
         RowBox[{"[", "t2i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"triangle1", " ", "=", " ", 
        RowBox[{"Complement", "[", 
         RowBox[{"triangle1", ",", 
          RowBox[{"{", "index", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"triangle2", " ", "=", " ", 
        RowBox[{"Complement", "[", 
         RowBox[{"triangle2", ",", 
          RowBox[{"{", "index", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"temp1", " ", "=", " ", 
        RowBox[{"Intersection", "[", 
         RowBox[{
          RowBox[{"segments", "[", 
           RowBox[{"[", 
            RowBox[{"triangle1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"segments", "[", 
           RowBox[{"[", 
            RowBox[{"triangle1", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"temp2", " ", "=", " ", 
        RowBox[{"Intersection", "[", 
         RowBox[{
          RowBox[{"segments", "[", 
           RowBox[{"[", 
            RowBox[{"triangle2", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"segments", "[", 
           RowBox[{"[", 
            RowBox[{"triangle2", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"segmentN", " ", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"temp1", ",", "1"}], "]"}], ",", " ", 
          RowBox[{"Flatten", "[", 
           RowBox[{"temp2", ",", "1"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"temp1", " ", "=", " ", "triangle1"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"temp2", " ", "=", "triangle2"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"Intersection", "[", 
            RowBox[{
             RowBox[{"segments", "[", 
              RowBox[{"[", 
               RowBox[{"triangle2", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"segments", "[", 
              RowBox[{"[", 
               RowBox[{"triangle1", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}], "]"}], 
          "\[Equal]", " ", "1"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"triangle1", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"temp1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"temp2", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "index"}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"triangle2", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"temp2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"temp1", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "index"}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<temp2[2].st = \>\"", ",", 
              RowBox[{"st", "[", 
               RowBox[{"[", 
                RowBox[{"temp2", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<temp1[2].st = \>\"", ",", 
              RowBox[{"st", "[", 
               RowBox[{"[", 
                RowBox[{"temp1", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}], ";"}],
            "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"st", "[", 
            RowBox[{"[", 
             RowBox[{"temp2", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "=", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"st", "[", 
                RowBox[{"[", 
                 RowBox[{"temp2", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", " ", 
               RowBox[{"{", "t2i", "}"}]}], "]"}], ",", "t1i"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"st", "[", 
            RowBox[{"[", 
             RowBox[{"temp1", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "=", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"st", "[", 
                RowBox[{"[", 
                 RowBox[{"temp1", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", " ", 
               RowBox[{"{", "t1i", "}"}]}], "]"}], ",", "t2i"}], "]"}]}], 
          ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"triangle1", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"temp1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"temp2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "index"}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"triangle2", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"temp2", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"temp1", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "index"}], "}"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"st", "[", 
            RowBox[{"[", 
             RowBox[{"temp2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "=", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"st", "[", 
                RowBox[{"[", 
                 RowBox[{"temp2", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"{", " ", "t2i", "}"}]}], "]"}], ",", "t1i"}], "]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"st", "[", 
            RowBox[{"[", 
             RowBox[{"temp1", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "=", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"st", "[", 
                RowBox[{"[", 
                 RowBox[{"temp1", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", " ", 
               RowBox[{"{", "t1i", "}"}]}], "]"}], ",", "t2i"}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"segments", " ", "[", 
         RowBox[{"[", "index", "]"}], "]"}], " ", "=", " ", "segmentN"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"triangles", "[", 
         RowBox[{"[", "t1i", "]"}], "]"}], " ", "=", " ", "triangle1"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"triangles", "[", 
         RowBox[{"[", "t2i", "]"}], "]"}], " ", "=", " ", "triangle2"}], 
       ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6257384235636463`*^9, 3.625738431738061*^9}, {
   3.6257386286202087`*^9, 3.6257391242954836`*^9}, {3.625739192774004*^9, 
   3.625739355269291*^9}, {3.6257394385990376`*^9, 3.625739470940895*^9}, {
   3.625739678670661*^9, 3.6257396816346664`*^9}, {3.6257397354763613`*^9, 
   3.6257397368803635`*^9}, {3.6257398739310055`*^9, 3.625739922952292*^9}, {
   3.62574022218622*^9, 3.625740231764637*^9}, {3.6257404788688726`*^9, 
   3.6257404884784894`*^9}, {3.6257405242865524`*^9, 
   3.6257405287949605`*^9}, {3.62574061356091*^9, 3.625740657823188*^9}, {
   3.625742318666868*^9, 3.625742335920498*^9}, {3.625742508831202*^9, 
   3.6257425432292624`*^9}, {3.6257425909965463`*^9, 3.625742726420384*^9}, {
   3.6257427672612557`*^9, 3.6257428132657366`*^9}, {3.625742970779213*^9, 
   3.6257429748820205`*^9}, {3.6257430539741592`*^9, 3.625743077686201*^9}, {
   3.625743208944832*^9, 3.625743224498059*^9}, {3.625743259988121*^9, 
   3.6257433267094383`*^9}, {3.625743384975541*^9, 3.625743406347578*^9}, {
   3.6257434638648796`*^9, 3.625743558276245*^9}, {3.6257436101463366`*^9, 
   3.625743612860741*^9}, {3.625743954298541*^9, 3.625744152621689*^9}, {
   3.6257441885329523`*^9, 3.6257442042265797`*^9}, {3.6257442485462575`*^9, 
   3.6257443319128036`*^9}, {3.62574442644897*^9, 3.625744427930973*^9}, {
   3.625744491828685*^9, 3.6257444989266973`*^9}, 3.6257939495143533`*^9, {
   3.6257940154712687`*^9, 3.625794189005974*^9}, {3.6257962231115475`*^9, 
   3.625796241160779*^9}, {3.625796301512885*^9, 3.6257963392961516`*^9}, {
   3.6257964046602664`*^9, 3.6257965664949503`*^9}, {3.625796648644695*^9, 
   3.6257966787863474`*^9}, {3.625796734166445*^9, 3.625796887046714*^9}, {
   3.6257969672464542`*^9, 3.6257969793832755`*^9}, {3.625797141639161*^9, 
   3.6257971655384026`*^9}, {3.6257972244753065`*^9, 3.62579725541016*^9}, {
   3.6257994266123743`*^9, 3.625799440293598*^9}, {3.626015446918624*^9, 
   3.6260154540457277`*^9}, {3.6260156790423594`*^9, 
   3.6260156881420856`*^9}, {3.626015834446515*^9, 3.6260158407571807`*^9}, {
   3.6260180759939127`*^9, 3.6260180769939284`*^9}, {3.6260194530163813`*^9, 
   3.626019526730932*^9}, {3.6260195653382034`*^9, 3.626019565587804*^9}, {
   3.626019603855117*^9, 3.626019607935979*^9}, 3.6260196395853662`*^9, 
   3.6260216816599493`*^9, {3.6260234774909987`*^9, 3.626023504866125*^9}, {
   3.626023567535369*^9, 3.6260235862533894`*^9}, {3.6260237537736235`*^9, 
   3.6260237842600594`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"CheckStart", "[", "]"}], " ", ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "triangle", ",", "stemp", ",", "tresult", ",", "\[IndentingNewLine]", 
       "triangle2", ",", "triangle1", ",", "\[IndentingNewLine]", "temp1", 
       ",", "temp2", ",", 
       RowBox[{"end", " ", "=", " ", "False"}], ",", "\[IndentingNewLine]", 
       "i", ",", "n"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"!", "end"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"end", " ", "=", " ", "True"}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", " ", "=", " ", "1"}], ",", 
           RowBox[{"i", " ", "\[LessEqual]", "  ", 
            RowBox[{"Length", "[", "triangles", "]"}]}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"triangle", " ", "=", " ", 
             RowBox[{"triangles", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"n", " ", "=", " ", "1"}], ",", 
              RowBox[{"n", " ", "\[LessEqual]", "  ", 
               RowBox[{"Length", "[", "triangle", "]"}]}], ",", 
              RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"stemp", " ", "=", " ", 
                RowBox[{"st", "[", 
                 RowBox[{"[", 
                  RowBox[{"triangle", "[", 
                   RowBox[{"[", "n", "]"}], "]"}], "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "stemp", "]"}], "\[Equal]", " ", 
                  "2"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"triangle1", " ", "=", " ", 
                   RowBox[{"triangles", "[", 
                    RowBox[{"[", 
                    RowBox[{"stemp", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"triangle2", " ", "=", "  ", 
                   RowBox[{"triangles", "[", 
                    RowBox[{"[", 
                    RowBox[{"stemp", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"triangle1", " ", "=", " ", 
                   RowBox[{"Complement", "[", 
                    RowBox[{"triangle1", ",", 
                    RowBox[{"{", 
                    RowBox[{"triangle", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "}"}]}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"triangle2", " ", "=", " ", 
                   RowBox[{"Complement", "[", 
                    RowBox[{"triangle2", ",", 
                    RowBox[{"{", 
                    RowBox[{"triangle", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "}"}]}], "]"}]}], ";", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"temp1", " ", "=", " ", 
                   RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"segments", "[", 
                    RowBox[{"[", 
                    RowBox[{"triangle1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"segments", "[", 
                    RowBox[{"[", 
                    RowBox[{"triangle1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}]}], 
                  ";", "\[IndentingNewLine]", 
                  RowBox[{"temp2", " ", "=", " ", 
                   RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"segments", "[", 
                    RowBox[{"[", 
                    RowBox[{"triangle2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"segments", "[", 
                    RowBox[{"[", 
                    RowBox[{"triangle2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}]}], 
                  ";", "\[IndentingNewLine]", 
                  RowBox[{"tresult", " ", "=", " ", 
                   RowBox[{"Test", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"temp1", ",", "1"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"segments", "[", 
                    RowBox[{"[", 
                    RowBox[{"triangle", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"temp2", ",", "1"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"segments", "[", 
                    RowBox[{"[", 
                    RowBox[{"triangle", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{"tresult", ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"flags", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", "True"}], 
                    ";"}], "*)"}], "\[IndentingNewLine]", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Flip", "[", 
                    RowBox[{"triangle", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"end", " ", "=", "False"}], ";"}]}], 
                   "\[IndentingNewLine]", "]"}], ";"}]}], 
                "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.62602092219387*^9, 3.6260211033190527`*^9}, {
   3.6260212384463997`*^9, 3.6260214429709797`*^9}, {3.6260215319152017`*^9, 
   3.6260215551001234`*^9}, {3.6260216372473593`*^9, 
   3.6260216684658985`*^9}, {3.6260217275268407`*^9, 3.626021737360971*^9}, {
   3.6260217918130817`*^9, 3.626021830422393*^9}, {3.6260218846362915`*^9, 
   3.626021959694276*^9}, {3.626022039398711*^9, 3.626022058265744*^9}, {
   3.626022089949789*^9, 3.626022093147398*^9}, {3.626022186482831*^9, 
   3.626022240850937*^9}, {3.6260222796068125`*^9, 3.626022300063695*^9}, {
   3.6260223406622925`*^9, 3.6260223641707845`*^9}, {3.626022440618723*^9, 
   3.626022446044188*^9}, {3.6260226845606728`*^9, 3.6260228110830617`*^9}, 
   3.626022952122088*^9, {3.6260229864287395`*^9, 3.6260230598450613`*^9}, 
   3.626023150673256*^9, {3.626023210521037*^9, 3.62602325138661*^9}, {
   3.626023285917564*^9, 3.626023289474599*^9}, {3.6260233482243805`*^9, 
   3.6260233598113127`*^9}, {3.626023689445772*^9, 3.6260237057599707`*^9}, {
   3.626023738747016*^9, 3.626023742580278*^9}, {3.626024054193078*^9, 
   3.626024060213344*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SegmentIntersect", "[", 
    RowBox[{"p_", ",", "q_"}], "]"}], ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "flag", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"flag", " ", "=", " ", 
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Det", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "-", 
                 RowBox[{"p", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"q", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "-", 
                 RowBox[{"p", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], "]"}], "*", 
             RowBox[{"Det", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "-", 
                 RowBox[{"p", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"q", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "-", 
                 RowBox[{"p", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], "]"}]}], ")"}], 
           ">", "0"}], "||", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Det", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"q", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "-", 
                 RowBox[{"q", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "-", 
                 RowBox[{"q", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], "]"}], "*", 
             RowBox[{"Det", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"q", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "-", 
                 RowBox[{"q", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "-", 
                 RowBox[{"q", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], "]"}]}], ")"}], 
           ">", "0"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "flag", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FindMidlePoint", "[", "triangle_", "]"}], ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "ab", ",", " ", "ac", ",", "cb", ",", "\[IndentingNewLine]", "N", ",", 
       "T", ",", "\[IndentingNewLine]", "line1", ",", "line2", ",", 
       "\[IndentingNewLine]", "midlePoint"}], "\[IndentingNewLine]", "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ab", " ", "=", " ", 
       RowBox[{"segments", "[", 
        RowBox[{"[", 
         RowBox[{"triangle", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ac", " ", "=", " ", 
       RowBox[{"segments", "[", 
        RowBox[{"[", 
         RowBox[{"triangle", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"cb", " ", "=", " ", 
       RowBox[{"segments", "[", 
        RowBox[{"[", 
         RowBox[{"triangle", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"line1", " ", "=", " ", 
       RowBox[{"Intersection", "[", 
        RowBox[{"ab", ",", "cb"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"line1", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ac", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"ac", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "/", "2"}]}], "]"}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"line2", " ", "=", " ", 
       RowBox[{"Intersection", "[", 
        RowBox[{"ab", ",", "ac"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"line2", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"cb", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"cb", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "/", "2"}]}], "]"}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"N", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Part", "[", 
            RowBox[{
             RowBox[{"line2", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "2"}], "]"}]}], "+", 
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"line2", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "2"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"line2", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}], "-", 
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"line2", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}]}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"T", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"line2", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", 
            RowBox[{"line1", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ")"}], ".", "N"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"line1", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", 
            RowBox[{"line1", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ")"}], ".", "N"}], ")"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"midlePoint", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"line1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", "T"}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"line1", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "*", "T"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "midlePoint", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AddPoint", "[", "point_", "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "triangle", ",", "\[IndentingNewLine]", "points", ",", 
        "\[IndentingNewLine]", "midlePoint", ",", "\[IndentingNewLine]", 
        "line", ",", "\[IndentingNewLine]", "segment", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"flag", " ", "=", " ", "True"}], ",", "\[IndentingNewLine]", 
        RowBox[{"index", " ", "=", "1"}], ",", "\[IndentingNewLine]", 
        "lastIndex", ",", "\[IndentingNewLine]", "stN", " ", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"triangle1", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"triangle2", "  ", "=", " ", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"triangle3", "=", "  ", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "i"}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"While", "[", 
        RowBox[{"flag", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"triangle", " ", "=", " ", 
           RowBox[{"triangles", "[", 
            RowBox[{"[", "index", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"midlePoint", " ", "=", " ", 
           RowBox[{"FindMidlePoint", "[", "triangle", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"line", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{"point", ",", " ", "midlePoint"}], "}"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", "index", "]"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"segment", " ", "=", " ", 
           RowBox[{"segments", "[", 
            RowBox[{"[", 
             RowBox[{"triangle", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"SegmentIntersect", "[", 
             RowBox[{"line", ",", "segment"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"index", " ", "=", 
              RowBox[{
               RowBox[{"Complement", "[", 
                RowBox[{
                 RowBox[{"st", "[", 
                  RowBox[{"[", 
                   RowBox[{"triangle", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
                 RowBox[{"{", "index", "}"}]}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]",
             ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"segment", " ", "=", " ", 
              RowBox[{"segments", "[", 
               RowBox[{"[", 
                RowBox[{"triangle", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"SegmentIntersect", "[", 
                RowBox[{"line", ",", "segment"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"index", " ", "=", 
                 RowBox[{
                  RowBox[{"Complement", "[", 
                   RowBox[{
                    RowBox[{"st", "[", 
                    RowBox[{"[", 
                    RowBox[{"triangle", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", "index", "}"}]}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ";"}], 
               "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"segment", " ", "=", " ", 
                 RowBox[{"segments", "[", 
                  RowBox[{"[", 
                   RowBox[{"triangle", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"SegmentIntersect", "[", 
                   RowBox[{"line", ",", "segment"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"index", " ", "=", 
                    RowBox[{
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"st", "[", 
                    RowBox[{"[", 
                    RowBox[{"triangle", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", "index", "}"}]}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], 
                  "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"flag", " ", "=", " ", "False"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"triangle", " ", "=", " ", 
        RowBox[{"triangles", "[", 
         RowBox[{"[", "index", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"points", " ", "=", " ", 
        RowBox[{"Union", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{"segments", "[", 
              RowBox[{"[", 
               RowBox[{"triangle", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", " ", 
             RowBox[{"segments", "[", 
              RowBox[{"[", 
               RowBox[{"triangle", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", " ", 
             RowBox[{"segments", "[", 
              RowBox[{"[", 
               RowBox[{"triangle", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
           "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"lastIndex", "  ", "=", " ", 
        RowBox[{"Length", "[", "segments", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"segments", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"points", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", " ", "point"}], "}"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"segments", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"points", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", " ", "point"}], "}"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"segments", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"points", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", " ", "point"}], "}"}]}], 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{"i", " ", "\[LessEqual]", " ", "3"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"stN", " ", "=", " ", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"segments", "[", 
                RowBox[{"[", 
                 RowBox[{"triangle", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"points", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}], "]"}], ";"}],
            "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"points", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"Complement", "[", 
               RowBox[{
                RowBox[{"segments", "[", 
                 RowBox[{"[", 
                  RowBox[{"triangle", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"points", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}], "]"}], 
             "\[Equal]", " ", "1"}], ",", " ", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"triangle1", ",", 
               RowBox[{"lastIndex", " ", "+", "i"}]}], " ", "]"}], ";", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"stN", ",", "index"}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"Complement", "[", 
               RowBox[{
                RowBox[{"segments", "[", 
                 RowBox[{"[", 
                  RowBox[{"triangle", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"points", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}], "]"}], 
             "\[Equal]", " ", "1"}], ",", " ", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"triangle2", ",", 
               RowBox[{"lastIndex", " ", "+", "i"}]}], " ", "]"}], ";", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"stN", ",", 
               RowBox[{
                RowBox[{"Length", "[", "triangles", "]"}], "+", "1"}]}], 
              "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"Complement", "[", 
               RowBox[{
                RowBox[{"segments", "[", 
                 RowBox[{"[", 
                  RowBox[{"triangle", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"points", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}], "]"}], 
             "\[Equal]", " ", "1"}], ",", " ", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"triangle3", ",", 
               RowBox[{"lastIndex", " ", "+", "i"}]}], " ", "]"}], ";", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"stN", ",", 
               RowBox[{
                RowBox[{"Length", "[", "triangles", "]"}], "+", "2"}]}], 
              "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"st", ",", "stN"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"triangle1", ",", 
         RowBox[{"triangle", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"triangle2", ",", 
         RowBox[{"triangle", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"triangle3", ",", 
         RowBox[{"triangle", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", "triangle1", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", "triangle2", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", "triangle3", "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"st", "[", 
         RowBox[{"[", 
          RowBox[{"triangle", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], " ", "=", " ", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Complement", "[", 
           RowBox[{
            RowBox[{"st", "[", 
             RowBox[{"[", 
              RowBox[{"triangle", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", " ", 
            RowBox[{"{", "index", "}"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"Length", "[", "triangles", "]"}], "+", "1"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"st", "[", 
         RowBox[{"[", 
          RowBox[{"triangle", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}], " ", "=", " ", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Complement", "[", 
           RowBox[{
            RowBox[{"st", "[", 
             RowBox[{"[", 
              RowBox[{"triangle", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}], ",", " ", 
            RowBox[{"{", "index", "}"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"Length", "[", "triangles", "]"}], "+", "2"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"triangles", "[", 
         RowBox[{"[", "index", "]"}], "]"}], " ", "=", " ", "triangle1"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"triangles", ",", "triangle2"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"triangles", ",", " ", "triangle3"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Triangulation", "[", "]"}], " ", ":=", " ", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "polygon", ",", "\[IndentingNewLine]", "pointsN", ",", 
      "\[IndentingNewLine]", "result", ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "i", ",", "leng", ",", "n"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"polygon", " ", "=", " ", 
      RowBox[{"PolygonBilder", "[", "points", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"polygon", " ", "=", " ", 
      RowBox[{"Delete", "[", 
       RowBox[{"polygon", ",", " ", 
        RowBox[{"Length", "[", "polygon", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pointsN", " ", "=", 
      RowBox[{"KickPoints", "[", "polygon", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"leng", " ", "=", " ", 
      RowBox[{"Length", "[", "polygon", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"i", " ", "<", " ", "leng"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"segments", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"polygon", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"polygon", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"segments", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"polygon", "[", 
          RowBox[{"[", "leng", "]"}], "]"}], ",", 
         RowBox[{"polygon", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", " ", 
       RowBox[{"i", " ", "\[LessEqual]", "  ", "leng"}], ",", " ", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"segments", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"polygon", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"pointsN", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", " ", 
       RowBox[{"i", " ", "<", "  ", "leng"}], ",", " ", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"triangles", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", 
            RowBox[{"leng", "+", "i"}], ",", " ", 
            RowBox[{"leng", "+", "i", "+", "1"}]}], "}"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"triangles", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"leng", "*", "2"}], ",", " ", 
         RowBox[{"leng", "+", "1"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", " ", 
       RowBox[{"i", " ", "\[LessEqual]", " ", "leng"}], ",", " ", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"st", ",", 
          RowBox[{"{", "i", "}"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"st", ",", 
       RowBox[{"{", 
        RowBox[{"leng", ",", "1"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "2"}], ",", " ", 
       RowBox[{"i", " ", "\[LessEqual]", "  ", "leng"}], ",", " ", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"st", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"i", "-", "1"}], ",", "i"}], "}"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"CheckStart", "[", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"n", " ", "=", " ", "2"}], ",", "  ", 
       RowBox[{"n", "\[LessEqual]", " ", 
        RowBox[{"Length", "[", "pointsN", "]"}]}], ",", 
       RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AddPoint", "[", 
         RowBox[{"pointsN", "[", 
          RowBox[{"[", "n", "]"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"CheckStart", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "result", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.625724015221585*^9, 3.6257241974767056`*^9}, {
   3.6257242527320023`*^9, 3.62572426875323*^9}, {3.6257243612613926`*^9, 
   3.6257243981554575`*^9}, {3.6257244458915415`*^9, 
   3.6257244602435665`*^9}, {3.625724503627243*^9, 3.6257247397024574`*^9}, 
   3.6257248246914067`*^9, {3.6257249411924114`*^9, 3.625724976276873*^9}, {
   3.625734538531969*^9, 3.625734575305234*^9}, {3.625735003404811*^9, 
   3.6257350255940504`*^9}, {3.625735063149317*^9, 3.625735090078964*^9}, {
   3.6257351379010487`*^9, 3.625735139601452*^9}, {3.6257352374754243`*^9, 
   3.6257353377176013`*^9}, {3.625736013223194*^9, 3.6257361270725946`*^9}, {
   3.625736188156703*^9, 3.625736276198658*^9}, {3.625736921163596*^9, 
   3.625736984900708*^9}, {3.6257983095444126`*^9, 3.625798372552923*^9}, {
   3.625798482467516*^9, 3.6257985124663687`*^9}, {3.6260161177658725`*^9, 
   3.6260161831417313`*^9}, {3.626020705047053*^9, 3.6260207677651567`*^9}, {
   3.6260208066146536`*^9, 3.626020819688155*^9}, {3.626023915271926*^9, 
   3.6260239197885895`*^9}, 3.6260239949759736`*^9, 3.6260240303255243`*^9, {
   3.6260240911457725`*^9, 3.6260241108090277`*^9}, {3.626024164686563*^9, 
   3.626024244470996*^9}, {3.6263325807372246`*^9, 3.6263326638439364`*^9}, {
   3.6263328978201*^9, 3.6263329488658395`*^9}, {3.6263330600265408`*^9, 
   3.6263331024755573`*^9}, {3.626333295667993*^9, 3.6263333944338813`*^9}, {
   3.6263335160028577`*^9, 3.6263335326577435`*^9}, {3.6263335860057316`*^9, 
   3.6263336476887074`*^9}, {3.6263336930348024`*^9, 3.626333731597746*^9}, {
   3.626333767064597*^9, 3.626333778565361*^9}, {3.6263339836393166`*^9, 
   3.626334031127486*^9}, {3.6263340694374046`*^9, 3.6263341738859186`*^9}, {
   3.6263342534813485`*^9, 3.6263342889947023`*^9}, {3.6263343228635273`*^9, 
   3.626334338394404*^9}, {3.626334388322109*^9, 3.626334403774977*^9}, {
   3.6263346149866037`*^9, 3.6263346235102863`*^9}, {3.6263346737710023`*^9, 
   3.6263346823692226`*^9}, {3.626336111250759*^9, 3.6263361343367896`*^9}, {
   3.6263361717507205`*^9, 3.6263361945167475`*^9}, {3.6263362286245775`*^9, 
   3.6263362660025015`*^9}, {3.626336316354213*^9, 3.626336456024087*^9}, {
   3.626336494502486*^9, 3.6263364991081*^9}, {3.6263365344399457`*^9, 
   3.6263366628845525`*^9}, {3.6263367006244717`*^9, 
   3.6263367652645245`*^9}, {3.626336842263899*^9, 3.6263368762647266`*^9}, {
   3.6263369092685003`*^9, 3.626336924061857*^9}, {3.6263369664053993`*^9, 
   3.62633702419887*^9}, {3.626337290194277*^9, 3.6263372905722985`*^9}, {
   3.626337355283353*^9, 3.626337373805812*^9}, {3.626337423497017*^9, 
   3.6263374534572415`*^9}, {3.626337578977455*^9, 3.6263375902002144`*^9}, {
   3.626337749096057*^9, 3.626337773702656*^9}, {3.626337850209491*^9, 
   3.62633788837043*^9}, {3.626337961985214*^9, 3.6263379725614653`*^9}, 
   3.626338127708212*^9, {3.62633817360881*^9, 3.6263382281051283`*^9}, {
   3.6263383255669622`*^9, 3.6263383961851797`*^9}, {3.626338477742648*^9, 
   3.6263384947265415`*^9}, {3.626338743840062*^9, 3.6263387842880335`*^9}, {
   3.626338909669057*^9, 3.626338942598873*^9}, {3.6263389917455626`*^9, 
   3.626339027354916*^9}, {3.6263390660098257`*^9, 3.6263390719421906`*^9}, {
   3.6263391292605515`*^9, 3.626339326222807*^9}, {3.6263393976320486`*^9, 
   3.6263394393010435`*^9}, {3.626339483497619*^9, 3.6263395407714777`*^9}, {
   3.626339852571637*^9, 3.6263398668609796`*^9}, {3.6263399038713617`*^9, 
   3.6263401062207346`*^9}, {3.6263402277226954`*^9, 3.626340240350478*^9}, {
   3.6263402936667786`*^9, 3.6263404310300727`*^9}, 3.6263405228533134`*^9, {
   3.626340634725243*^9, 3.626340639155355*^9}, {3.626340753592132*^9, 
   3.626340761421801*^9}, {3.626340926987318*^9, 3.6263409617761526`*^9}, {
   3.6263418804135017`*^9, 3.6263418826425743`*^9}, 3.626341979285395*^9, 
   3.626342183776845*^9, {3.6263422775411034`*^9, 3.6263422832952533`*^9}, {
   3.6263424293417687`*^9, 3.626342460915516*^9}, {3.6263425706321645`*^9, 
   3.626342573184246*^9}, {3.6263430462587366`*^9, 3.6263430669392323`*^9}, {
   3.6263431225445843`*^9, 3.6263431344453864`*^9}, {3.6263431803049903`*^9, 
   3.62634320893369*^9}, {3.626343486141898*^9, 3.6263435307539797`*^9}, {
   3.6263437622227144`*^9, 3.6263437892984123`*^9}, {3.6263439325848866`*^9, 
   3.6263439346704607`*^9}, {3.6263440552323666`*^9, 3.626344057996925*^9}, {
   3.6263443173686976`*^9, 3.6263443724600186`*^9}, {3.626344448524401*^9, 
   3.626344483480765*^9}, {3.6263446595968347`*^9, 3.626344688847064*^9}, {
   3.6263447468604383`*^9, 3.626344754410141*^9}, {3.626345088427348*^9, 
   3.6263451057642684`*^9}, {3.6263453092986994`*^9, 3.626345329148179*^9}, {
   3.6263453864700627`*^9, 3.626345386612565*^9}, {3.62634553232113*^9, 
   3.6263455501750803`*^9}, {3.626345669777009*^9, 3.626345690308502*^9}, 
   3.6263457383506575`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"points", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "1000"}], "}"}], "]"}], ",", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "1000"}], "}"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", "30", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"segments", "=", " ", 
   RowBox[{"List", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"triangles", "=", " ", 
   RowBox[{"List", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"st", "=", " ", 
   RowBox[{"List", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"flags", "=", " ", 
   RowBox[{"List", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Triangulation", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Graphics", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Line", "[", "segments", "]"}], ",", " ", 
    RowBox[{"Point", "[", "points", "]"}], ",", "Red", ",", " ", 
    RowBox[{"Point", "[", 
     RowBox[{"KickPoints", "[", 
      RowBox[{"PolygonBilder", "[", "points", "]"}], "]"}], "]"}]}], "}"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.6263423128989673`*^9, 3.626342330026867*^9}, {
   3.6263426169837646`*^9, 3.626342620752365*^9}, {3.6263427104095545`*^9, 
   3.6263427864143815`*^9}, {3.626342876785119*^9, 3.6263429104609427`*^9}, 
   3.626344590606161*^9, 3.626344649690096*^9, {3.6263449895484724`*^9, 
   3.6263450073548765`*^9}, {3.6263457508249726`*^9, 3.62634577309649*^9}, {
   3.626345868606352*^9, 3.6263458712119217`*^9}}],

Cell[BoxData[
 GraphicsBox[{LineBox[CompressedData["
1:eJxd1K1OZEEQBeCeuSHhAVAkm4BAYTYh8BIkhEBYgmTUCgICC4Ifs08wkhdA
jkCA2s1aHBYBBEdwGASHhC/dXHFy7umqPl3V1TPzo4ON/a6Ush4MvzAVnA5K
2Q4/dJWPg38Nj4PJsPJV+KxUXsraYsOj8p2dg2fDa825J+HLrsaXg/NgJngf
Vj0Jxsm5Dw+C3/k+KjXuPP78foVvm/5o/nfh667u48uvr9XB50/4Yli1ftT1
Gkw3/cmXR2N1if8PPzZxWly+9X5fP/L90twjrV/r/OmbYDWYy9pzcw/6788F
fz6udi58xGm8+1lPqfNRt/5o75G233twLj/xw+iF5l7Mg09frwQ/uzrvt6xv
Nf3R3jvtnvp56pJPm4P61GEdq0efzuFD89e/++fPbyf42/yeaT72483kPQ0q
d+G9Uvfxl0/zp9Vnv3za/0nfX//mT/OnnaNOcZo//QEHkZ8p
    "]], PointBox[{{503, 85}, {479, 257}, {98, 43}, {309, 388}, {601, 707}, {
    952, 131}, {436, 151}, {198, 740}, {86, 975}, {893, 964}, {26, 334}, {496,
     776}, {470, 956}, {137, 671}, {919, 692}, {851, 485}, {512, 124}, {104, 
    124}, {87, 995}, {445, 331}, {609, 238}, {563, 43}, {822, 816}, {544, 
    231}, {627, 549}, {541, 750}, {771, 108}, {276, 764}, {129, 940}, {5, 
    386}}], 
   {RGBColor[1, 0, 0], 
    PointBox[{{26, 334}, {86, 975}, {104, 124}, {129, 940}, {137, 671}, {198, 
     740}, {276, 764}, {309, 388}, {436, 151}, {445, 331}, {470, 956}, {479, 
     257}, {496, 776}, {503, 85}, {512, 124}, {541, 750}, {544, 231}, {601, 
     707}, {609, 238}, {627, 549}, {771, 108}, {822, 816}, {851, 485}}]}},
  ImageSize->{456., Automatic}]], "Output",
 CellChangeTimes->{{3.626342773134585*^9, 3.626342787053892*^9}, {
   3.6263428842358193`*^9, 3.626342914411046*^9}, 3.62634308037107*^9, 
   3.626343141375544*^9, 3.6263434393432407`*^9, 3.626343534907588*^9, 
   3.626343570050454*^9, 3.6263436482314034`*^9, 3.626343766578325*^9, 
   3.6263439438751926`*^9, 3.62634406167301*^9, {3.6263443316410475`*^9, 
   3.6263443526060405`*^9}, {3.6263444384536552`*^9, 3.626344486490324*^9}, 
   3.626344591763179*^9, 3.6263446647024555`*^9, 3.626344699135811*^9, 
   3.626344762339307*^9, 3.626345008121395*^9, 3.62634510947087*^9, 
   3.6263453329217367`*^9, 3.626345390900174*^9, 3.626345554737711*^9, {
   3.6263457189527125`*^9, 3.6263458774080606`*^9}}]
}, Open  ]]
},
WindowSize->{1898, 1065},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 12656, 287, 1292, "Input"],
Cell[13216, 309, 693, 15, 132, "Input"],
Cell[13912, 326, 17460, 402, 1252, "Input"],
Cell[31375, 730, 7724, 155, 732, "Input"],
Cell[39102, 887, 31022, 706, 2892, "Input"],
Cell[CellGroupData[{
Cell[70149, 1597, 1710, 42, 152, "Input"],
Cell[71862, 1641, 2006, 31, 505, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
