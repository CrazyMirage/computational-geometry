(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     47837,       1152]
NotebookOptionsPosition[     47019,       1123]
NotebookOutlinePosition[     47363,       1138]
CellTagsIndexPosition[     47320,       1135]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"PointGenerator", "[", 
     RowBox[{"num_", ",", " ", "polygon_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"P", " ", "=", " ", 
         RowBox[{"List", "[", "]"}]}], ",", 
        RowBox[{"Pvector", "=", 
         RowBox[{"List", "[", "]"}]}], ",", "\[IndentingNewLine]", "PI", ",", 
        "PIvector", ",", "\[IndentingNewLine]", "i", ",", "t", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"minX", "=", " ", "Infinity"}], ",", 
        RowBox[{"minY", "=", "Infinity"}], ",", "\[IndentingNewLine]", 
        RowBox[{"maxX", " ", "=", " ", 
         RowBox[{"-", "1"}]}], ",", " ", 
        RowBox[{"maxY", " ", "=", 
         RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", "length", ",", 
        "\[IndentingNewLine]", "result"}], " ", "\[IndentingNewLine]", "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"length", " ", "=", " ", 
        RowBox[{"Length", "[", "polygon", "]"}]}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{"i", " ", "\[LessEqual]", " ", "length"}], ",", 
         RowBox[{"++", "i"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"polygon", ",", "i"}], "]"}], ",", "1"}], "]"}], "<", 
             "minX"}], ",", 
            RowBox[{"minX", " ", "=", 
             RowBox[{"Part", "[", 
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"polygon", ",", "i"}], "]"}], ",", "1"}], "]"}]}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"polygon", ",", "i"}], "]"}], ",", "2"}], "]"}], "<", 
             "minY"}], ",", 
            RowBox[{"minY", " ", "=", 
             RowBox[{"Part", "[", 
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"polygon", ",", "i"}], "]"}], ",", "2"}], "]"}]}]}], 
           "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"polygon", ",", "i"}], "]"}], ",", "1"}], "]"}], ">", 
             "maxX"}], ",", 
            RowBox[{"maxX", " ", "=", 
             RowBox[{"Part", "[", 
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"polygon", ",", "i"}], "]"}], ",", "1"}], "]"}]}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"polygon", ",", "i"}], "]"}], ",", "2"}], "]"}], ">", 
             " ", "maxY"}], ",", 
            RowBox[{"maxY", " ", "=", 
             RowBox[{"Part", "[", 
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"polygon", ",", "i"}], "]"}], ",", "2"}], "]"}]}]}], 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", " ", 
        RowBox[{
         RowBox[{"t", " ", "=", " ", "0"}], ",", " ", 
         RowBox[{"t", "<", " ", "num"}], ",", " ", 
         RowBox[{
          RowBox[{"t", "++"}], ";"}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"PI", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"RandomInteger", "[", 
              RowBox[{"{", 
               RowBox[{"minX", ",", " ", "maxX"}], "}"}], "]"}], ",", " ", 
             RowBox[{"RandomInteger", "[", 
              RowBox[{"{", 
               RowBox[{"minY", ",", " ", "maxY"}], "}"}], "]"}]}], "}"}]}], 
          ";", " ", "\[IndentingNewLine]", "\t ", 
          RowBox[{"PIvector", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"RandomInteger", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "50"}], ",", " ", "50"}], "}"}], "]"}], ",", " ", 
             RowBox[{"RandomInteger", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "50"}], ",", " ", "50"}], "}"}], "]"}]}], 
            "}"}]}], ";", " ", "\[IndentingNewLine]", "\t", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"Pvector", ",", "PIvector"}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"P", ",", "PI"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"result", " ", "=", 
        RowBox[{"{", 
         RowBox[{"P", ",", "Pvector"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "result", "]"}], ";"}]}], "]"}]}], 
   ";"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PoligonPreCount", "[", "SPolygon_", "]"}], " ", ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"P", " ", "=", " ", 
        RowBox[{"List", "[", "]"}]}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"S", " ", "=", 
        RowBox[{"List", "[", "]"}]}], ",", " ", "\[IndentingNewLine]", 
       "result", ",", "n", ",", "\[IndentingNewLine]", "smallPolygonLength"}],
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"smallPolygonLength", " ", "=", " ", 
       RowBox[{"Length", "[", "SPolygon", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"n", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"n", " ", "<", "smallPolygonLength"}], " ", ",", " ", 
        RowBox[{"++", "n"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"P", ",", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{"SPolygon", ",", " ", 
              RowBox[{"n", "+", "1"}]}], "]"}], "-", 
            RowBox[{"Part", "[", 
             RowBox[{"SPolygon", ",", " ", "n"}], "]"}]}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", " ", "[", "P", "]"}]}]}], "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PolygonSizes", " ", "[", "polygon_", "]"}], ":=", " ", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"minX", "=", " ", "Infinity"}], ",", 
      RowBox[{"minY", "=", "Infinity"}], ",", "\[IndentingNewLine]", 
      RowBox[{"maxX", " ", "=", " ", 
       RowBox[{"-", "1"}]}], ",", " ", 
      RowBox[{"maxY", " ", "=", 
       RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", "length", ",", 
      "\[IndentingNewLine]", "result"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"length", " ", "=", " ", 
      RowBox[{"Length", "[", "polygon", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"i", " ", "\[LessEqual]", " ", "length"}], ",", 
       RowBox[{"++", "i"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Part", "[", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"polygon", ",", "i"}], "]"}], ",", "1"}], "]"}], "<", 
           "minX"}], ",", 
          RowBox[{"minX", " ", "=", 
           RowBox[{"Part", "[", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"polygon", ",", "i"}], "]"}], ",", "1"}], "]"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Part", "[", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"polygon", ",", "i"}], "]"}], ",", "2"}], "]"}], "<", 
           "minY"}], ",", 
          RowBox[{"minY", " ", "=", 
           RowBox[{"Part", "[", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"polygon", ",", "i"}], "]"}], ",", "2"}], "]"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Part", "[", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"polygon", ",", "i"}], "]"}], ",", "1"}], "]"}], ">", 
           "maxX"}], ",", 
          RowBox[{"maxX", " ", "=", 
           RowBox[{"Part", "[", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"polygon", ",", "i"}], "]"}], ",", "1"}], "]"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Part", "[", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"polygon", ",", "i"}], "]"}], ",", "2"}], "]"}], ">", 
           " ", "maxY"}], ",", 
          RowBox[{"maxY", " ", "=", 
           RowBox[{"Part", "[", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"polygon", ",", "i"}], "]"}], ",", "2"}], "]"}]}]}], 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"minX", ",", "minY"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"maxX", ",", " ", "maxY"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "result", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"move", "[", 
    RowBox[{"polygon_", ",", "SPPC_", ",", " ", "PSize_"}], "]"}], " ", ":=", 
   " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"P", "=", 
        RowBox[{"List", "[", "]"}]}], ",", "\[IndentingNewLine]", "PI", ",", 
       "P1", ",", "\[IndentingNewLine]", "VI", ",", "V1", ",", 
       "\[IndentingNewLine]", "b", ",", "a", ",", "\[IndentingNewLine]", "i", 
       ",", "n", ",", "n2", ",", "\[IndentingNewLine]", "length", ",", 
       "\[IndentingNewLine]", "polygonLength", ",", "\[IndentingNewLine]", 
       RowBox[{"flag", " ", "=", "1"}], ",", "\[IndentingNewLine]", 
       "result"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"length", " ", "=", " ", 
       RowBox[{"Length", "[", "points", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"polygonLength", " ", "=", " ", 
       RowBox[{"Length", "[", "polygon", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"i", " ", "<=", " ", "length"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{"vectors", ",", " ", "i"}], "]"}], " ", "\[Equal]", " ", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], ",", 
           RowBox[{"Print", "[", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"points", ",", "i"}], "]"}], ",", " ", "i"}], "]"}], 
           ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"PI", "=", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{"points", ",", "i"}], "]"}], "+", 
              RowBox[{"(", 
               RowBox[{"Part", "[", 
                RowBox[{"vectors", ",", "i"}], "]"}], ")"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"P1", " ", "=", " ", 
             RowBox[{"Part", "[", 
              RowBox[{"points", ",", "i"}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Test", "[", 
               RowBox[{"PI", ",", "PSize"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Part", "[", 
                 RowBox[{"points", ",", "i"}], "]"}], " ", "=", " ", "PI"}], 
               ";"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"For", "[", 
                RowBox[{
                 RowBox[{"n", " ", "=", " ", "1"}], ",", " ", 
                 RowBox[{
                  RowBox[{"n", " ", "<", "polygonLength"}], " ", "&&", "  ", 
                  RowBox[{"flag", " ", "==", " ", "1"}]}], ",", " ", 
                 RowBox[{"++", "n"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Det", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Part", "[", 
                    RowBox[{"SPPC", ",", " ", "n"}], "]"}], ",", 
                    RowBox[{"PI", "-", 
                    RowBox[{"Part", "[", 
                    RowBox[{"polygon", ",", "n"}], "]"}]}]}], "}"}], "]"}], 
                    "*", 
                    RowBox[{"Det", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Part", "[", 
                    RowBox[{"SPPC", ",", " ", "n"}], "]"}], ",", 
                    RowBox[{"P1", "-", 
                    RowBox[{"Part", "[", 
                    RowBox[{"polygon", ",", "n"}], "]"}]}]}], "}"}], "]"}]}], 
                    " ", ">", " ", "0"}], ")"}], "||", "\[IndentingNewLine]", 
                    "\t\t ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Det", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"PI", "-", "P1"}], ",", 
                    RowBox[{
                    RowBox[{"Part", "[", 
                    RowBox[{"polygon", ",", "n"}], "]"}], "-", "P1"}]}], 
                    "}"}], "]"}], "*", 
                    RowBox[{"Det", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"PI", "-", "P1"}], ",", 
                    RowBox[{
                    RowBox[{"Part", "[", 
                    RowBox[{"polygon", ",", 
                    RowBox[{"n", "+", "1"}]}], "]"}], "-", "P1"}]}], "}"}], 
                    "]"}]}], ">", "0"}], " ", ")"}]}], ")"}], 
                    "\[IndentingNewLine]", "\t\t\t", ",", 
                    "\[IndentingNewLine]", ",", " ", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"b", "=", 
                    RowBox[{
                    RowBox[{"Part", "[", 
                    RowBox[{"polygon", ",", " ", 
                    RowBox[{"n", "+", "1"}]}], "]"}], "-", 
                    RowBox[{"Part", "[", 
                    RowBox[{"polygon", ",", " ", "n"}], "]"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"a", " ", "=", 
                    RowBox[{"Part", "[", 
                    RowBox[{"vectors", ",", "i"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"VI", " ", "=", " ", 
                    RowBox[{
                    RowBox[{"2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"a", ".", "b"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"b", ".", "b"}], ")"}]}], ")"}], "*", "b"}], " ", 
                    "-", " ", "a"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Part", "[", 
                    RowBox[{"vectors", ",", "i"}], "]"}], " ", "=", " ", 
                    "VI"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"flag", " ", "=", "0"}]}]}], "]"}], ";"}]}], 
                "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"flag", " ", "\[Equal]", " ", "1"}], ",", " ", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Print", "[", "\"\<\:0445\:043c...\>\"", "]"}]}], 
                "]"}], ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"result", " ", "=", " ", 
       RowBox[{"NearestPair", "[", "points", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"minLine", " ", "=", " ", 
       RowBox[{"result", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"result", "[", 
          RowBox[{"[", "2", "]"}], "]"}], " ", "<", " ", "200"}], ",", 
        RowBox[{
        "textField", " ", "=", " ", 
         "\"\<\:0411\:0430\:0434\:0430\:0431\:0443\:043c!!!\>\""}], ",", " ", 
        RowBox[{"textField", " ", "=", " ", "\"\< \>\""}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "points", "]"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6233005063945336`*^9, 3.6233005419606123`*^9}, 
   3.6233007389976664`*^9, {3.6233195011914845`*^9, 3.6233195352474318`*^9}, {
   3.623319991200511*^9, 3.6233201043049803`*^9}, {3.623320212904192*^9, 
   3.6233202131192045`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SegmentLength", "[", 
   RowBox[{"P1_", ",", "P2_"}], "]"}], ":=", " ", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"Px2", ",", "Py2"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Px2", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"P1", ",", "1"}], "]"}], "-", 
         RowBox[{"Part", "[", 
          RowBox[{"P2", ",", "1"}], "]"}]}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"P1", ",", "1"}], "]"}], "-", 
         RowBox[{"Part", "[", 
          RowBox[{"P2", ",", "1"}], "]"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Py2", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"P1", ",", "2"}], "]"}], "-", 
         RowBox[{"Part", "[", 
          RowBox[{"P2", ",", "2"}], "]"}]}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"P1", ",", "2"}], "]"}], "-", 
         RowBox[{"Part", "[", 
          RowBox[{"P2", ",", "2"}], "]"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"Px2", " ", "+", " ", "Py2"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Test", "[", 
   RowBox[{"point_", ",", " ", "PSize_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"flag", " ", "=", " ", "True"}], ",", "\[IndentingNewLine]", 
      "X", ",", "Y", ",", "\[IndentingNewLine]", "minX", ",", "minY", ",", 
      "\[IndentingNewLine]", "maxX", ",", " ", "maxY", ","}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"X", "=", " ", 
      RowBox[{"Part", "[", 
       RowBox[{"point", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Y", " ", "=", " ", 
      RowBox[{"Part", "[", 
       RowBox[{"point", ",", " ", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"minX", " ", "=", " ", 
      RowBox[{"Part", "[", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"PSize", ",", " ", "1"}], "]"}], ",", "1"}], "]"}]}], ";", 
     " ", 
     RowBox[{"minY", " ", "=", " ", 
      RowBox[{"Part", "[", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"PSize", ",", " ", "1"}], "]"}], ",", "2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"maxX", " ", "=", " ", 
      RowBox[{"Part", "[", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"PSize", ",", " ", "2"}], "]"}], ",", "1"}], "]"}]}], ";", 
     " ", 
     RowBox[{"maxY", " ", "=", " ", 
      RowBox[{"Part", "[", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"PSize", ",", " ", "2"}], "]"}], ",", "2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"maxX", " ", ">", " ", "X", " ", ">", " ", "minX"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{"maxY", ">", " ", "Y", " ", ">", " ", "minY"}], ")"}]}], ",",
        ",", 
       RowBox[{"flag", " ", "=", " ", "False"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "flag", "]"}]}]}], "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"NearestPair", "[", "points_", "]"}], " ", ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Points", " ", "=", " ", 
         RowBox[{"List", "[", "]"}]}], ",", "\[IndentingNewLine]", "result"}],
        "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Points", " ", "=", " ", "points"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Points", " ", "=", " ", 
        RowBox[{"SortBy", "[", 
         RowBox[{"Points", ",", " ", "First"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"result", " ", "=", 
        RowBox[{"NearestPairHelper", "[", "Points", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "result", "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NearestPairHelper", "[", "Points_", "]"}], " ", ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"P1", " ", "=", " ", 
         RowBox[{"List", "[", "]"}]}], ",", 
        RowBox[{"P2", "=", " ", 
         RowBox[{"List", "[", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"minLength", " ", "=", " ", "Infinity"}], ",", "nextLength", 
        ",", "\[IndentingNewLine]", "result", ",", "\[IndentingNewLine]", 
        "length", ",", "\[IndentingNewLine]", "firstResult", ",", 
        "secondResult", ",", "\[IndentingNewLine]", "halfLength", ",", " ", 
        RowBox[{"prePoints", " ", "=", " ", 
         RowBox[{"List", "[", "]"}]}], ",", "\[IndentingNewLine]", "mid", ",",
         "i", ",", "n", ",", "flag"}], "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"length", " ", "=", " ", 
        RowBox[{"Length", "[", "Points", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"length", ">", "3"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"halfLength", " ", "=", " ", 
           RowBox[{"IntegerPart", "[", 
            RowBox[{"length", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]",
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"firstResult", " ", "=", " ", 
           RowBox[{"NearestPairHelper", "[", 
            RowBox[{"Points", "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", "halfLength"}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"secondResult", " ", "=", 
           RowBox[{"NearestPairHelper", "[", 
            RowBox[{"Points", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"halfLength", "+", "1"}], ";;", "length"}], "]"}], 
             "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"firstResult", ",", " ", "2"}], "]"}], "<", " ", 
             RowBox[{"Part", "[", 
              RowBox[{"secondResult", ",", " ", "2"}], "]"}]}], ",", 
            RowBox[{"result", " ", "=", " ", "firstResult"}], ",", " ", 
            RowBox[{"result", " ", "=", " ", "secondResult"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"minLength", " ", "=", " ", 
           RowBox[{"result", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"mid", " ", "=", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"Part", "[", 
                 RowBox[{"Points", ",", "halfLength"}], "]"}], ",", "1"}], 
               "]"}], "+", " ", 
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"Part", "[", 
                 RowBox[{"Points", ",", 
                  RowBox[{"halfLength", "+", "1"}]}], "]"}], ",", "1"}], 
               "]"}]}], ")"}], "/", "2"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"mids", ",", "mid"}], "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", "  ", "=", " ", "1"}], " ", ",", " ", 
            RowBox[{"i", " ", "\[LessEqual]", " ", "length"}], ",", " ", 
            RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{
                  RowBox[{"Part", "[", 
                   RowBox[{
                    RowBox[{"Part", "[", 
                    RowBox[{"Points", ",", "i"}], "]"}], ",", "1"}], "]"}], 
                  " ", "-", " ", "mid"}], " ", "]"}], "<", " ", "minLength"}],
                ",", " ", 
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{"prePoints", ",", 
                  RowBox[{"Part", "[", 
                   RowBox[{"Points", ",", "i"}], "]"}]}], "]"}], ";"}]}], 
              "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"prePoints", " ", "=", " ", 
           RowBox[{"SortBy", "[", 
            RowBox[{"prePoints", ",", " ", "Last"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"length", " ", "=", " ", 
           RowBox[{"Length", "[", "prePoints", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
            RowBox[{"i", " ", "<", " ", "length"}], ",", " ", 
            RowBox[{"++", "i"}], ",", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"flag", " ", "=", " ", "True"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"n", " ", "=", " ", 
                RowBox[{"i", "+", "1"}]}], ",", " ", 
               RowBox[{
                RowBox[{"n", " ", "\[LessEqual]", " ", "length"}], "&&", " ", 
                RowBox[{"n", " ", "\[LessEqual]", " ", 
                 RowBox[{"i", "+", "7"}]}], "&&", "flag"}], ",", " ", 
               RowBox[{"++", "n"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{"Part", "[", 
                    RowBox[{"prePoints", ",", "n"}], "]"}], ",", "2"}], "]"}],
                     "-", 
                    RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{"Part", "[", 
                    RowBox[{"prePoints", ",", "i"}], "]"}], ",", "2"}], 
                    "]"}]}], "<", " ", "minLength"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"nextLength", " ", "=", " ", 
                    RowBox[{"SegmentLength", "[", 
                    RowBox[{
                    RowBox[{"Part", "[", 
                    RowBox[{"prePoints", ",", "i"}], "]"}], ",", 
                    RowBox[{"Part", "[", 
                    RowBox[{"prePoints", ",", "n"}], "]"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"minLength", "  ", ">", " ", "nextLength"}], ",", 
                    RowBox[{
                    RowBox[{"minLength", " ", "=", " ", "nextLength"}], ";", 
                    " ", 
                    RowBox[{"P1", " ", "=", " ", 
                    RowBox[{"Part", "[", 
                    RowBox[{"prePoints", ",", "i"}], "]"}]}], ";", " ", 
                    RowBox[{"P2", " ", "=", " ", 
                    RowBox[{"Part", "[", 
                    RowBox[{"prePoints", ",", "n"}], "]"}]}]}]}], "]"}], 
                   ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"flag", " ", "=", " ", "False"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"result", "[", 
              RowBox[{"[", "2", "]"}], "]"}], " ", ">", " ", "minLength"}], 
            ",", 
            RowBox[{
             RowBox[{"result", " ", "=", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"P1", ",", " ", "P2"}], "}"}], ",", " ", 
                "minLength"}], "}"}]}], ";"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
            RowBox[{"i", " ", "<", " ", "length"}], ",", " ", 
            RowBox[{"++", "i"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"n", " ", "=", " ", 
                RowBox[{"i", "+", "1"}]}], ",", " ", 
               RowBox[{"n", " ", "\[LessEqual]", " ", "length"}], ",", " ", 
               RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"nextLength", " ", "=", " ", 
                 RowBox[{"SegmentLength", "[", 
                  RowBox[{
                   RowBox[{"Part", "[", 
                    RowBox[{"Points", ",", "i"}], "]"}], ",", 
                   RowBox[{"Part", "[", 
                    RowBox[{"Points", ",", "n"}], "]"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"minLength", "  ", ">", " ", "nextLength"}], ",", 
                  RowBox[{
                   RowBox[{"minLength", " ", "=", " ", "nextLength"}], ";", 
                   " ", 
                   RowBox[{"P1", " ", "=", " ", 
                    RowBox[{"Part", "[", 
                    RowBox[{"Points", ",", "i"}], "]"}]}], ";", " ", 
                   RowBox[{"P2", " ", "=", " ", 
                    RowBox[{"Part", "[", 
                    RowBox[{"Points", ",", "n"}], "]"}]}]}]}], "]"}], ";"}]}],
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"result", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"P1", ",", " ", "P2"}], "}"}], ",", " ", "minLength"}], 
            "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "result", "]"}], ";"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mids", "=", " ", 
     RowBox[{"List", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"myPoints", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1242", ",", "5387"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"455", ",", "9554"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"7540", ",", "376"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5718", ",", "3848"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"9236", ",", "4937"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"8573", ",", "9716"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4773", ",", "3298"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5106", ",", "3480"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5463", ",", "5092"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2648", ",", "7947"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"6378", ",", "1937"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"704", ",", "1317"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"8682", ",", "7854"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"9090", ",", "7438"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3308", ",", "5941"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"6271", ",", "9916"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"6746", ",", "6958"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"6145", ",", "1104"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1088", ",", "8779"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"7740", ",", "7678"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ncdc", "=", " ", 
    RowBox[{"NearestPair", "[", "myPoints", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Point", "[", "myPoints", "]"}], ",", " ", "Green", ",", 
      RowBox[{"Line", "[", 
       RowBox[{"Part", "[", 
        RowBox[{"ncdc", ",", "1"}], "]"}], "]"}], ",", " ", "Red", ",", " ", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"mids", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", " ", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"mids", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", " ", "10000"}], "}"}]}], 
        "}"}], "]"}]}], "}"}], "]"}], "\[IndentingNewLine]", "mids", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6233018096556005`*^9, 3.6233019028795767`*^9}, {
   3.6233019653655367`*^9, 3.6233019880778875`*^9}, {3.623302064496747*^9, 
   3.6233020755369167`*^9}, {3.6233021149765224`*^9, 
   3.6233021611502314`*^9}, {3.6233024361917076`*^9, 
   3.6233024664806747`*^9}, {3.6233025100638466`*^9, 3.623302523664056*^9}, {
   3.6233130241951103`*^9, 3.6233131028972483`*^9}, {3.6233131903978024`*^9, 
   3.623313193018607*^9}, {3.6233132237194605`*^9, 3.623313333840054*^9}, {
   3.623313467423089*^9, 3.623313691252282*^9}, {3.623313728505147*^9, 
   3.6233137677704163`*^9}, {3.6233138213849106`*^9, 3.623313947823133*^9}, {
   3.6233140119236455`*^9, 3.62331412285544*^9}, {3.62331431046137*^9, 
   3.6233143132225747`*^9}, {3.62331440741554*^9, 3.623314436837192*^9}, {
   3.6233146716176043`*^9, 3.623314802813835*^9}, {3.6233148535919237`*^9, 
   3.6233149558033037`*^9}, {3.623314986426157*^9, 3.6233150248022246`*^9}, {
   3.6233150620082903`*^9, 3.6233151490720425`*^9}, {3.6233151806932983`*^9, 
   3.62331522716578*^9}, {3.6233152629990425`*^9, 3.6233152677414513`*^9}, {
   3.623315305665118*^9, 3.623315400918885*^9}, 3.6233154721642103`*^9, {
   3.623315770124734*^9, 3.6233158677653055`*^9}, {3.6233160909915795`*^9, 
   3.623316140088866*^9}, {3.62331619375296*^9, 3.6233161945953617`*^9}, {
   3.623316226107417*^9, 3.623316312221568*^9}, {3.623316378327889*^9, 
   3.6233163917595124`*^9}, {3.623316423474368*^9, 3.6233164417576003`*^9}, {
   3.6233165841390505`*^9, 3.6233166258535233`*^9}, {3.6233167096100707`*^9, 
   3.6233167163804827`*^9}, {3.6233167578765554`*^9, 3.62331678865541*^9}, {
   3.623316829246681*^9, 3.6233169754813375`*^9}, {3.6233171030853205`*^9, 
   3.6233171069605417`*^9}, {3.623317222726164*^9, 3.6233174101428833`*^9}, {
   3.6233174654000435`*^9, 3.623317624554147*^9}, {3.623317660768218*^9, 
   3.6233177226157556`*^9}, {3.6233177920897293`*^9, 
   3.6233178694091516`*^9}, {3.62331796169743*^9, 3.6233181128050733`*^9}, {
   3.623318149218156*^9, 3.6233182720711823`*^9}, {3.623318306346143*^9, 
   3.623318306745166*^9}, {3.623318670327962*^9, 3.6233188501262455`*^9}, {
   3.623318881798057*^9, 3.6233189294527826`*^9}, {3.6233189994767876`*^9, 
   3.62331900108488*^9}, {3.623319082170518*^9, 3.6233191274351063`*^9}, {
   3.6233191986781816`*^9, 3.623319270171271*^9}, {3.6233193223422546`*^9, 
   3.6233194284533243`*^9}, {3.6233194739359255`*^9, 3.62331948695867*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4773", ",", "3298"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5106", ",", "3480"}], "}"}]}], "}"}], ",", 
   SqrtBox["144013"]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6233152304729857`*^9, 3.6233152742778625`*^9, 3.6233153310151625`*^9, 
   3.6233154024008875`*^9, 3.6233158600588913`*^9, {3.623316231692227*^9, 
   3.6233162609734783`*^9}, 3.6233178772095976`*^9, {3.6233179696568856`*^9, 
   3.623317995293352*^9}, 3.623318080654234*^9, 3.62331811397314*^9, {
   3.6233182109336853`*^9, 3.623318273229249*^9}, 3.623318307626216*^9, {
   3.6233187187017283`*^9, 3.623318754660785*^9}, {3.6233188221176434`*^9, 
   3.623318851143304*^9}, {3.6233188889634666`*^9, 3.623318930959869*^9}, 
   3.623319001872925*^9, {3.6233191186536045`*^9, 3.623319128780184*^9}, {
   3.6233192458388786`*^9, 3.6233192713683395`*^9}, 3.6233193282795944`*^9, 
   3.6233193621125298`*^9, 3.623319542671857*^9}],

Cell[BoxData[
 GraphicsBox[{
   PointBox[{{1242, 5387}, {455, 9554}, {7540, 376}, {5718, 3848}, {9236, 
    4937}, {8573, 9716}, {4773, 3298}, {5106, 3480}, {5463, 5092}, {2648, 
    7947}, {6378, 1937}, {704, 1317}, {8682, 7854}, {9090, 7438}, {3308, 
    5941}, {6271, 9916}, {6746, 6958}, {6145, 1104}, {1088, 8779}, {7740, 
    7678}}], 
   {RGBColor[0, 1, 0], LineBox[{{4773, 3298}, {5106, 3480}}]}, 
   {RGBColor[1, 0, 0], 
    LineBox[NCache[{{Rational[9879, 2], 0}, {Rational[9879, 2], 10000}}, {{
       4939.5, 0}, {4939.5, 10000}}]]}}]], "Output",
 CellChangeTimes->{
  3.6233152304729857`*^9, 3.6233152742778625`*^9, 3.6233153310151625`*^9, 
   3.6233154024008875`*^9, 3.6233158600588913`*^9, {3.623316231692227*^9, 
   3.6233162609734783`*^9}, 3.6233178772095976`*^9, {3.6233179696568856`*^9, 
   3.623317995293352*^9}, 3.623318080654234*^9, 3.62331811397314*^9, {
   3.6233182109336853`*^9, 3.623318273229249*^9}, 3.623318307626216*^9, {
   3.6233187187017283`*^9, 3.623318754660785*^9}, {3.6233188221176434`*^9, 
   3.623318851143304*^9}, {3.6233188889634666`*^9, 3.623318930959869*^9}, 
   3.623319001872925*^9, {3.6233191186536045`*^9, 3.623319128780184*^9}, {
   3.6233192458388786`*^9, 3.6233192713683395`*^9}, 3.6233193282795944`*^9, 
   3.6233193621125298`*^9, 3.6233195426738567`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"896", ",", 
   FractionBox["9879", "2"], ",", "2978", ",", 
   FractionBox["12649", "2"], ",", 
   FractionBox["17255", "2"], ",", "7640", ",", 
   FractionBox["11863", "2"]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6233152304729857`*^9, 3.6233152742778625`*^9, 3.6233153310151625`*^9, 
   3.6233154024008875`*^9, 3.6233158600588913`*^9, {3.623316231692227*^9, 
   3.6233162609734783`*^9}, 3.6233178772095976`*^9, {3.6233179696568856`*^9, 
   3.623317995293352*^9}, 3.623318080654234*^9, 3.62331811397314*^9, {
   3.6233182109336853`*^9, 3.623318273229249*^9}, 3.623318307626216*^9, {
   3.6233187187017283`*^9, 3.623318754660785*^9}, {3.6233188221176434`*^9, 
   3.623318851143304*^9}, {3.6233188889634666`*^9, 3.623318930959869*^9}, 
   3.623319001872925*^9, {3.6233191186536045`*^9, 3.623319128780184*^9}, {
   3.6233192458388786`*^9, 3.6233192713683395`*^9}, 3.6233193282795944`*^9, 
   3.6233193621125298`*^9, 3.623319542675857*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"square", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "10001"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10001", ",", "10001"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10001", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pointVector", " ", "=", " ", 
   RowBox[{"PointGenerator", "[", 
    RowBox[{"20", ",", " ", "square"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"points", " ", "=", " ", 
  RowBox[{"Part", "[", 
   RowBox[{"pointVector", ",", "1"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vectors", " ", "=", " ", 
   RowBox[{"Part", "[", 
    RowBox[{"pointVector", ",", " ", "2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BPPC", " ", "=", " ", 
   RowBox[{"PoligonPreCount", "[", "square", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PSize", " ", "=", " ", 
   RowBox[{"PolygonSizes", "[", "square", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"minLine", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"textField", ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Graphics", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Line", "[", 
     RowBox[{"{", "square", "}"}], "]"}], ",", " ", "Red", ",", 
    RowBox[{"Point", "[", 
     RowBox[{"{", "square", "}"}], "]"}], ",", "Blue", ",", " ", 
    RowBox[{"Point", "[", 
     RowBox[{"{", 
      RowBox[{"Dynamic", "[", 
       RowBox[{"move", "[", 
        RowBox[{"square", ",", "BPPC", ",", "PSize"}], "]"}], "]"}], "}"}], 
     "]"}], ",", " ", "Green", ",", " ", 
    RowBox[{"Line", "[", 
     RowBox[{"Dynamic", "[", "minLine", "]"}], "]"}], ",", " ", "Red", ",", 
    " ", 
    RowBox[{"Text", "[", 
     RowBox[{
      RowBox[{"Dynamic", "[", "textField", "]"}], " ", ",", "Center"}], 
     "]"}]}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.623299547932686*^9, 3.623299548322708*^9}, 
   3.623299847641828*^9, 3.6232999049921083`*^9, {3.6233007554805655`*^9, 
   3.6233007556680684`*^9}, 3.623314904791214*^9, {3.623319447835432*^9, 
   3.6233194618752356`*^9}, {3.623319570839468*^9, 3.6233196030903125`*^9}, {
   3.6233197231261783`*^9, 3.6233197512787886`*^9}, {3.6233199447038517`*^9, 
   3.6233199448538604`*^9}, {3.623320118088769*^9, 3.6233201574580207`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"6548", ",", "6182"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4932", ",", "4485"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7740", ",", "9648"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5264", ",", "1065"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2335", ",", "6852"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4723", ",", "4499"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5914", ",", "2986"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6765", ",", "5959"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3646", ",", "5122"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7528", ",", "8153"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6505", ",", "9846"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1324", ",", "1904"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"9263", ",", "1666"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1533", ",", "100"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4955", ",", "3690"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6433", ",", "1269"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4572", ",", "271"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8070", ",", "5828"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5354", ",", "1759"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3181", ",", "2826"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.623319548688201*^9, {3.623319590177574*^9, 3.6233196041973763`*^9}, {
   3.6233201328946157`*^9, 3.62332015814706*^9}}],

Cell[BoxData[
 GraphicsBox[{
   LineBox[{{{-1, -1}, {-1, 10001}, {10001, 10001}, {10001, -1}, {-1, -1}}}], 
   {RGBColor[1, 0, 0], 
    PointBox[{{{-1, -1}, {-1, 10001}, {10001, 10001}, {
     10001, -1}, {-1, -1}}}]}, 
   {RGBColor[0, 0, 1], 
    PointBox[{
     Dynamic[$CellContext`move[$CellContext`square, $CellContext`BPPC, \
$CellContext`PSize]]}]}, 
   {RGBColor[0, 1, 0], LineBox[Dynamic[$CellContext`minLine]]}, 
   {RGBColor[1, 0, 0], InsetBox[
     DynamicBox[ToBoxes[$CellContext`textField, TraditionalForm],
      ImageSizeCache->{3., {1., 5.}}], Center]}}]], "Output",
 CellChangeTimes->{
  3.623319548688201*^9, {3.623319590177574*^9, 3.6233196041973763`*^9}, {
   3.6233201328946157`*^9, 3.62332015815606*^9}}]
}, Open  ]]
},
WindowSize->{1904, 1065},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 5314, 130, 552, "Input"],
Cell[5874, 152, 1412, 32, 232, "Input"],
Cell[7289, 186, 3441, 91, 372, "Input"],
Cell[10733, 279, 8153, 180, 912, "Input"],
Cell[18889, 461, 1482, 43, 172, "Input"],
Cell[20374, 506, 2067, 54, 272, "Input"],
Cell[CellGroupData[{
Cell[22466, 564, 16344, 353, 1492, "Input"],
Cell[38813, 919, 1004, 20, 36, "Output"],
Cell[39820, 941, 1306, 21, 422, "Output"],
Cell[41129, 964, 980, 17, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42146, 986, 2629, 69, 212, "Input"],
Cell[44778, 1057, 1495, 45, 52, "Output"],
Cell[46276, 1104, 727, 16, 374, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

